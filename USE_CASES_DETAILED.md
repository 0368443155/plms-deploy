# TÃ€I LIá»†U CHI TIáº¾T CÃC USE CASE VÃ€ BIá»‚U Äá»’ HOáº T Äá»˜NG

## NgÃ y táº¡o: 01/12/2025
## PhiÃªn báº£n: 1.0

---

## Má»¤C Lá»¤C

1. [UC01: ÄÄƒng nháº­p](#uc01-Ä‘Äƒng-nháº­p)
2. [UC02: ÄÄƒng kÃ½](#uc02-Ä‘Äƒng-kÃ½)
3. [UC03: ÄÄƒng xuáº¥t](#uc03-Ä‘Äƒng-xuáº¥t)
4. [UC04: QuÃªn máº­t kháº©u](#uc04-quÃªn-máº­t-kháº©u)
5. [UC05: Cáº­p nháº­t thÃ´ng tin cÃ¡ nhÃ¢n](#uc05-cáº­p-nháº­t-thÃ´ng-tin-cÃ¡-nhÃ¢n)
6. [UC06: Äá»•i máº­t kháº©u](#uc06-Ä‘á»•i-máº­t-kháº©u)
7. [UC07: Táº¡o trang má»›i](#uc07-táº¡o-trang-má»›i)
8. [UC08: Cáº­p nháº­t trang](#uc08-cáº­p-nháº­t-trang)
9. [UC09: Sá»­a ná»™i dung trang](#uc09-sá»­a-ná»™i-dung-trang)
10. [UC10: Äá»c ná»™i dung trang](#uc10-Ä‘á»c-ná»™i-dung-trang)
11. [UC11: XÃ³a trang](#uc11-xÃ³a-trang)
12. [UC12: KhÃ´i phá»¥c/XÃ³a vÄ©nh viá»…n](#uc12-khÃ´i-phá»¥c-xÃ³a-vÄ©nh-viá»…n)
13. [UC13: TÃ¬m kiáº¿m trang](#uc13-tÃ¬m-kiáº¿m-trang)
14. [UC14: Quáº£n lÃ½ cÃ¡c báº£ng dá»¯ liá»‡u](#uc14-quáº£n-lÃ½-cÃ¡c-báº£ng-dá»¯-liá»‡u)
15. [UC15: Quáº£n lÃ½ lá»‹ch há»c](#uc15-quáº£n-lÃ½-lá»‹ch-há»c)
16. [UC16: Xem lá»‹ch tá»•ng quan](#uc16-xem-lá»‹ch-tá»•ng-quan)
17. [UC17: Nháº­n vÃ  xem thÃ´ng bÃ¡o](#uc17-nháº­n-vÃ -xem-thÃ´ng-bÃ¡o)
18. [UC18: TÃ³m táº¯t ná»™i dung trang](#uc18-tÃ³m-táº¯t-ná»™i-dung-trang)
19. [UC19: Há»i Ä‘Ã¡p trÃªn tÃ i liá»‡u](#uc19-há»i-Ä‘Ã¡p-trÃªn-tÃ i-liá»‡u)

---

## UC01: ÄÄ‚NG NHáº¬P

### ThÃ´ng tin cÆ¡ báº£n
- **Use Case ID:** UC01
- **Tráº¡ng thÃ¡i:** âœ… ÄÃ£ triá»ƒn khai (qua Clerk Auth)
- **Má»©c Ä‘á»™ Æ°u tiÃªn:** ğŸ”´ CAO
- **TÃ¡c nhÃ¢n:** NgÆ°á»i dÃ¹ng há»‡ thá»‘ng

### Biá»ƒu Ä‘á»“ hoáº¡t Ä‘á»™ng (Activity Diagram)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        UC01: ÄÄ‚NG NHáº¬P                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    [Báº¯t Ä‘áº§u]
        â”‚
        â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ NgÆ°á»i dÃ¹ng nháº¥n nÃºt   â”‚
    â”‚ "ÄÄƒng nháº­p"           â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Há»‡ thá»‘ng hiá»ƒn thá»‹     â”‚
    â”‚ form Ä‘Äƒng nháº­p        â”‚
    â”‚ (Email, Password)     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ NgÆ°á»i dÃ¹ng nháº­p       â”‚
    â”‚ thÃ´ng tin vÃ  submit   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Há»‡ thá»‘ng kiá»ƒm tra     â”‚
    â”‚ thÃ´ng tin Ä‘Äƒng nháº­p   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â–¼
         â—‡â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—‡
        /  ThÃ´ng tin    \
       /    há»£p lá»‡?      \
      â—‡â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—‡
      â”‚                   â”‚
   [CÃ³]                 [KhÃ´ng]
      â”‚                   â”‚
      â–¼                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Táº¡o session â”‚    â”‚ Hiá»ƒn thá»‹ lá»—i:    â”‚
â”‚ vÃ  token    â”‚    â”‚ "Email hoáº·c máº­t  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â”‚ kháº©u khÃ´ng Ä‘Ãºng" â”‚
       â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                    â”‚
       â”‚                    â–¼
       â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚           â”‚ Äáº¿m sá»‘ láº§n tháº¥t  â”‚
       â”‚           â”‚ báº¡i Ä‘Äƒng nháº­p    â”‚
       â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                    â”‚
       â”‚                    â–¼
       â”‚             â—‡â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—‡
       â”‚            / ÄÃ£ tháº¥t báº¡i   \
       â”‚           /   >= 5 láº§n?     \
       â”‚          â—‡â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—‡
       â”‚          â”‚                   â”‚
       â”‚        [CÃ³]               [KhÃ´ng]
       â”‚          â”‚                   â”‚
       â”‚          â–¼                   â”‚
       â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
       â”‚    â”‚ KhÃ³a tÃ i      â”‚          â”‚
       â”‚    â”‚ khoáº£n 30 phÃºt â”‚          â”‚
       â”‚    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
       â”‚           â”‚                  â”‚
       â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                    â”‚
       â”‚                    â–¼
       â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚           â”‚ YÃªu cáº§u nháº­p láº¡i â”‚
       â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                    â”‚
       â”‚                    â””â”€â”€â”€â”€â”€â”€â”
       â”‚                           â”‚
       â–¼                           â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚ Chuyá»ƒn hÆ°á»›ng    â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚ Ä‘áº¿n trang chÃ­nh â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Ghi log Ä‘Äƒng nháº­p     â”‚
    â”‚ (thá»i gian, IP, etc.) â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â–¼
           [Káº¿t thÃºc]
```

### Triá»ƒn khai hiá»‡n táº¡i

**File liÃªn quan:**
- `app/(marketing)/page.tsx` - Landing page vá»›i nÃºt Ä‘Äƒng nháº­p
- `app/layout.tsx` - ClerkProvider wrapper
- Clerk Dashboard - Cáº¥u hÃ¬nh authentication

**Code máº«u:**
```typescript
// app/(marketing)/page.tsx
import { SignInButton } from "@clerk/clerk-react";

export default function MarketingPage() {
  return (
    <div>
      <SignInButton mode="modal">
        <button>ÄÄƒng nháº­p</button>
      </SignInButton>
    </div>
  );
}
```

### Cáº§n bá»• sung

1. **Rate Limiting:**
```typescript
// convex/auth.ts
import { mutation } from "./_generated/server";

// Track login attempts
const loginAttempts = new Map<string, { count: number, lockedUntil?: number }>();

export const trackLoginAttempt = mutation({
  args: { email: v.string(), success: v.boolean() },
  handler: async (ctx, args) => {
    const now = Date.now();
    const attempts = loginAttempts.get(args.email) || { count: 0 };
    
    // Check if locked
    if (attempts.lockedUntil && now < attempts.lockedUntil) {
      throw new Error("TÃ i khoáº£n táº¡m thá»i bá»‹ khÃ³a. Vui lÃ²ng thá»­ láº¡i sau.");
    }
    
    if (args.success) {
      // Reset on success
      loginAttempts.delete(args.email);
    } else {
      // Increment failed attempts
      attempts.count++;
      
      if (attempts.count >= 5) {
        // Lock for 30 minutes
        attempts.lockedUntil = now + 30 * 60 * 1000;
      }
      
      loginAttempts.set(args.email, attempts);
    }
  }
});
```

2. **Activity Logging:**
```typescript
// convex/schema.ts
loginLogs: defineTable({
  userId: v.string(),
  email: v.string(),
  success: v.boolean(),
  ipAddress: v.optional(v.string()),
  userAgent: v.optional(v.string()),
  timestamp: v.number(),
})
.index("by_user", ["userId"])
.index("by_timestamp", ["timestamp"])
```

---

## UC02: ÄÄ‚NG KÃ

### ThÃ´ng tin cÆ¡ báº£n
- **Use Case ID:** UC02
- **Tráº¡ng thÃ¡i:** âœ… ÄÃ£ triá»ƒn khai (qua Clerk Auth)
- **Má»©c Ä‘á»™ Æ°u tiÃªn:** ğŸ”´ CAO
- **TÃ¡c nhÃ¢n:** NgÆ°á»i dÃ¹ng há»‡ thá»‘ng

### Biá»ƒu Ä‘á»“ hoáº¡t Ä‘á»™ng

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        UC02: ÄÄ‚NG KÃ                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    [Báº¯t Ä‘áº§u]
        â”‚
        â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ NgÆ°á»i dÃ¹ng nháº¥n nÃºt   â”‚
    â”‚ "ÄÄƒng kÃ½"             â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Há»‡ thá»‘ng hiá»ƒn thá»‹     â”‚
    â”‚ form Ä‘Äƒng kÃ½:         â”‚
    â”‚ - Há» tÃªn              â”‚
    â”‚ - Email               â”‚
    â”‚ - Sá»‘ Ä‘iá»‡n thoáº¡i       â”‚
    â”‚ - Giá»›i tÃ­nh           â”‚
    â”‚ - Máº­t kháº©u            â”‚
    â”‚ - XÃ¡c nháº­n máº­t kháº©u   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ NgÆ°á»i dÃ¹ng Ä‘iá»n       â”‚
    â”‚ thÃ´ng tin vÃ  submit   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Validate dá»¯ liá»‡u:     â”‚
    â”‚ - Email há»£p lá»‡        â”‚
    â”‚ - Password >= 8 kÃ½ tá»± â”‚
    â”‚ - Password khá»›p       â”‚
    â”‚ - Há» tÃªn khÃ´ng trá»‘ng  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â–¼
         â—‡â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—‡
        /  Dá»¯ liá»‡u      \
       /    há»£p lá»‡?      \
      â—‡â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—‡
      â”‚                   â”‚
   [CÃ³]                 [KhÃ´ng]
      â”‚                   â”‚
      â–¼                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Kiá»ƒm tra    â”‚    â”‚ Hiá»ƒn thá»‹ lá»—i     â”‚
â”‚ email Ä‘Ã£    â”‚    â”‚ validation       â”‚
â”‚ tá»“n táº¡i?    â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜             â”‚
       â”‚                    â”‚
       â–¼                    â”‚
  â—‡â”€â”€â”€â”€â”€â”€â”€â”€â”€â—‡               â”‚
 / Email Ä‘Ã£  \              â”‚
/   tá»“n táº¡i?  \             â”‚
â—‡â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—‡             â”‚
â”‚             â”‚             â”‚
[CÃ³]        [KhÃ´ng]         â”‚
â”‚             â”‚             â”‚
â–¼             â–¼             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ Hiá»ƒn thá»‹ â”‚  â”‚ Táº¡o tÃ i  â”‚  â”‚
â”‚ lá»—i:     â”‚  â”‚ khoáº£n    â”‚  â”‚
â”‚ "Email   â”‚  â”‚ trong    â”‚  â”‚
â”‚ Ä‘Ã£ Ä‘Æ°á»£c  â”‚  â”‚ Clerk    â”‚  â”‚
â”‚ sá»­ dá»¥ng" â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜       â”‚        â”‚
     â”‚             â–¼        â”‚
     â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
     â”‚    â”‚ Gá»­i email xÃ¡c  â”‚â”‚
     â”‚    â”‚ thá»±c (náº¿u báº­t) â”‚â”‚
     â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
     â”‚             â”‚        â”‚
     â”‚             â–¼        â”‚
     â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
     â”‚    â”‚ Táº¡o webhook    â”‚â”‚
     â”‚    â”‚ â†’ Sync to      â”‚â”‚
     â”‚    â”‚ Convex DB      â”‚â”‚
     â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
     â”‚             â”‚        â”‚
     â”‚             â–¼        â”‚
     â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
     â”‚    â”‚ Táº¡o user       â”‚â”‚
     â”‚    â”‚ profile trong  â”‚â”‚
     â”‚    â”‚ báº£ng "users"   â”‚â”‚
     â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
     â”‚             â”‚        â”‚
     â”‚             â–¼        â”‚
     â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
     â”‚    â”‚ Hiá»ƒn thá»‹ thÃ´ng â”‚â”‚
     â”‚    â”‚ bÃ¡o thÃ nh cÃ´ng â”‚â”‚
     â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
     â”‚             â”‚        â”‚
     â”‚             â–¼        â”‚
     â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
     â”‚    â”‚ Tá»± Ä‘á»™ng Ä‘Äƒng   â”‚â”‚
     â”‚    â”‚ nháº­p hoáº·c      â”‚â”‚
     â”‚    â”‚ redirect Ä‘áº¿n   â”‚â”‚
     â”‚    â”‚ trang Ä‘Äƒng nháº­pâ”‚â”‚
     â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
     â”‚             â”‚        â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
              [Káº¿t thÃºc]
```

### Triá»ƒn khai hiá»‡n táº¡i

**Clerk Configuration:**
- Sign up form vá»›i email/password
- Email verification (optional)
- OAuth providers (Google, GitHub)

### Cáº§n bá»• sung

1. **Custom Fields trong Clerk:**
```typescript
// Clerk Dashboard â†’ User & Authentication â†’ Email, Phone, Username
// Enable custom fields:
// - full_name (required)
// - phone (optional)
// - gender (optional)
```

2. **Webhook Ä‘á»ƒ sync user data:**
```typescript
// app/api/webhooks/clerk/route.ts
import { Webhook } from 'svix';
import { headers } from 'next/headers';
import { WebhookEvent } from '@clerk/nextjs/server';
import { api } from '@/convex/_generated/api';

export async function POST(req: Request) {
  const WEBHOOK_SECRET = process.env.CLERK_WEBHOOK_SECRET;
  
  const headerPayload = headers();
  const svix_id = headerPayload.get("svix-id");
  const svix_timestamp = headerPayload.get("svix-timestamp");
  const svix_signature = headerPayload.get("svix-signature");
  
  const body = await req.text();
  
  const wh = new Webhook(WEBHOOK_SECRET);
  
  let evt: WebhookEvent;
  
  try {
    evt = wh.verify(body, {
      "svix-id": svix_id!,
      "svix-timestamp": svix_timestamp!,
      "svix-signature": svix_signature!,
    }) as WebhookEvent;
  } catch (err) {
    return new Response('Error verifying webhook', { status: 400 });
  }
  
  if (evt.type === 'user.created') {
    // Sync to Convex
    await fetch(process.env.CONVEX_SITE_URL + '/api/users/create', {
      method: 'POST',
      body: JSON.stringify({
        clerkId: evt.data.id,
        email: evt.data.email_addresses[0].email_address,
        fullName: evt.data.first_name + ' ' + evt.data.last_name,
        phone: evt.data.phone_numbers[0]?.phone_number,
        avatarUrl: evt.data.image_url,
      })
    });
  }
  
  return new Response('', { status: 200 });
}
```

3. **Convex mutation Ä‘á»ƒ táº¡o user:**
```typescript
// convex/users.ts
export const createUser = mutation({
  args: {
    clerkId: v.string(),
    email: v.string(),
    fullName: v.string(),
    phone: v.optional(v.string()),
    avatarUrl: v.optional(v.string()),
  },
  handler: async (ctx, args) => {
    const existingUser = await ctx.db
      .query("users")
      .withIndex("by_clerk_id", q => q.eq("clerkId", args.clerkId))
      .first();
    
    if (existingUser) {
      return existingUser._id;
    }
    
    const userId = await ctx.db.insert("users", {
      clerkId: args.clerkId,
      email: args.email,
      fullName: args.fullName,
      phone: args.phone,
      avatarUrl: args.avatarUrl,
      createdAt: Date.now(),
      updatedAt: Date.now(),
    });
    
    return userId;
  }
});
```

---

## UC03: ÄÄ‚NG XUáº¤T

### ThÃ´ng tin cÆ¡ báº£n
- **Use Case ID:** UC03
- **Tráº¡ng thÃ¡i:** âœ… ÄÃ£ triá»ƒn khai
- **Má»©c Ä‘á»™ Æ°u tiÃªn:** ğŸŸ¡ TRUNG BÃŒNH
- **TÃ¡c nhÃ¢n:** NgÆ°á»i dÃ¹ng há»‡ thá»‘ng

### Biá»ƒu Ä‘á»“ hoáº¡t Ä‘á»™ng

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       UC03: ÄÄ‚NG XUáº¤T                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    [Báº¯t Ä‘áº§u]
        â”‚
        â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ NgÆ°á»i dÃ¹ng nháº¥n nÃºt   â”‚
    â”‚ "ÄÄƒng xuáº¥t"           â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Há»‡ thá»‘ng hiá»ƒn thá»‹     â”‚
    â”‚ xÃ¡c nháº­n (optional):  â”‚
    â”‚ "Báº¡n cÃ³ cháº¯c muá»‘n     â”‚
    â”‚ Ä‘Äƒng xuáº¥t?"           â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â–¼
         â—‡â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—‡
        /  NgÆ°á»i dÃ¹ng   \
       /   xÃ¡c nháº­n?     \
      â—‡â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—‡
      â”‚                   â”‚
   [CÃ³]                 [KhÃ´ng]
      â”‚                   â”‚
      â–¼                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Ghi log     â”‚    â”‚ Há»§y bá»       â”‚
â”‚ Ä‘Äƒng xuáº¥t   â”‚    â”‚ Ä‘Äƒng xuáº¥t    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                  â”‚
       â–¼                  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚ XÃ³a session â”‚           â”‚
â”‚ vÃ  token    â”‚           â”‚
â”‚ (Clerk)     â”‚           â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜           â”‚
       â”‚                  â”‚
       â–¼                  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚ XÃ³a cookies â”‚           â”‚
â”‚ client-side â”‚           â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜           â”‚
       â”‚                  â”‚
       â–¼                  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚ VÃ´ hiá»‡u hÃ³a â”‚           â”‚
â”‚ local       â”‚           â”‚
â”‚ storage     â”‚           â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜           â”‚
       â”‚                  â”‚
       â–¼                  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚ Redirect    â”‚           â”‚
â”‚ Ä‘áº¿n trang   â”‚           â”‚
â”‚ Ä‘Äƒng nháº­p   â”‚           â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜           â”‚
       â”‚                  â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â–¼
           [Káº¿t thÃºc]


    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  LUá»’NG PHá»¤: AUTO LOGOUT            â”‚
    â”‚  (KhÃ´ng hoáº¡t Ä‘á»™ng 120 phÃºt)        â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    
    [Báº¯t Ä‘áº§u]
        â”‚
        â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Theo dÃµi hoáº¡t Ä‘á»™ng    â”‚
    â”‚ cá»§a ngÆ°á»i dÃ¹ng        â”‚
    â”‚ (mouse, keyboard)     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â–¼
         â—‡â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—‡
        /  KhÃ´ng hoáº¡t   \
       /  Ä‘á»™ng 120 phÃºt? \
      â—‡â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—‡
      â”‚                   â”‚
   [CÃ³]                 [KhÃ´ng]
      â”‚                   â”‚
      â–¼                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Hiá»ƒn thá»‹    â”‚    â”‚ Tiáº¿p tá»¥c     â”‚
â”‚ cáº£nh bÃ¡o:   â”‚    â”‚ theo dÃµi     â”‚
â”‚ "Báº¡n sáº½ bá»‹  â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚ Ä‘Äƒng xuáº¥t   â”‚
â”‚ sau 60s"    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
  â—‡â”€â”€â”€â”€â”€â”€â”€â”€â”€â—‡
 / NgÆ°á»i dÃ¹ng\
/  cÃ³ hoáº¡t    \
\ Ä‘á»™ng?       /
 â—‡â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—‡
 â”‚           â”‚
[CÃ³]       [KhÃ´ng]
 â”‚           â”‚
 â–¼           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Resetâ”‚  â”‚ Tá»± Ä‘á»™ng     â”‚
â”‚ timerâ”‚  â”‚ Ä‘Äƒng xuáº¥t   â”‚
â””â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
         [Káº¿t thÃºc]
```

### Triá»ƒn khai hiá»‡n táº¡i

```typescript
// components/navigation.tsx
import { SignOutButton } from "@clerk/clerk-react";

export function Navigation() {
  return (
    <SignOutButton>
      <button>ÄÄƒng xuáº¥t</button>
    </SignOutButton>
  );
}
```

### Cáº§n bá»• sung: Auto Logout

```typescript
// hooks/use-idle-timer.tsx
import { useIdleTimer } from 'react-idle-timer';
import { useAuth } from '@clerk/clerk-react';
import { toast } from 'sonner';

export function useAutoLogout() {
  const { signOut } = useAuth();
  
  const onIdle = () => {
    toast.warning('Báº¡n sáº½ bá»‹ Ä‘Äƒng xuáº¥t sau 60 giÃ¢y do khÃ´ng hoáº¡t Ä‘á»™ng');
    
    setTimeout(() => {
      signOut();
      toast.info('ÄÃ£ tá»± Ä‘á»™ng Ä‘Äƒng xuáº¥t do khÃ´ng hoáº¡t Ä‘á»™ng');
    }, 60000);
  };
  
  const { getRemainingTime } = useIdleTimer({
    onIdle,
    timeout: 120 * 60 * 1000, // 120 minutes
    throttle: 500,
  });
  
  return { getRemainingTime };
}

// app/layout.tsx
'use client';

import { useAutoLogout } from '@/hooks/use-idle-timer';

export default function RootLayout({ children }) {
  useAutoLogout();
  
  return (
    <html>
      <body>{children}</body>
    </html>
  );
}
```

---

## UC04: QUÃŠN Máº¬T KHáº¨U

### ThÃ´ng tin cÆ¡ báº£n
- **Use Case ID:** UC04
- **Tráº¡ng thÃ¡i:** âš ï¸ Cáº§n kÃ­ch hoáº¡t (Clerk há»— trá»£ sáºµn)
- **Má»©c Ä‘á»™ Æ°u tiÃªn:** ğŸ”´ CAO
- **TÃ¡c nhÃ¢n:** NgÆ°á»i dÃ¹ng há»‡ thá»‘ng

### Biá»ƒu Ä‘á»“ hoáº¡t Ä‘á»™ng

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    UC04: QUÃŠN Máº¬T KHáº¨U                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    [Báº¯t Ä‘áº§u]
        â”‚
        â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ NgÆ°á»i dÃ¹ng á»Ÿ trang    â”‚
    â”‚ Ä‘Äƒng nháº­p, nháº¥n       â”‚
    â”‚ "QuÃªn máº­t kháº©u?"      â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Há»‡ thá»‘ng hiá»ƒn thá»‹     â”‚
    â”‚ trang "KhÃ´i phá»¥c      â”‚
    â”‚ máº­t kháº©u"             â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ NgÆ°á»i dÃ¹ng nháº­p       â”‚
    â”‚ email Ä‘Ã£ Ä‘Äƒng kÃ½      â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ NgÆ°á»i dÃ¹ng nháº¥n       â”‚
    â”‚ "Gá»­i"                 â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Há»‡ thá»‘ng kiá»ƒm tra     â”‚
    â”‚ email cÃ³ tá»“n táº¡i?     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â–¼
         â—‡â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—‡
        /  Email tá»“n    \
       /     táº¡i?        \
      â—‡â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—‡
      â”‚                   â”‚
   [CÃ³]                 [KhÃ´ng]
      â”‚                   â”‚
      â–¼                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Táº¡o mÃ£ OTP  â”‚    â”‚ Hiá»ƒn thá»‹ lá»—i:    â”‚
â”‚ (6 sá»‘)      â”‚    â”‚ "Email khÃ´ng há»£p â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â”‚ lá»‡ hoáº·c chÆ°a     â”‚
       â”‚           â”‚ Ä‘Äƒng kÃ½"         â”‚
       â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â–¼                    â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚ LÆ°u OTP vÃ o â”‚             â”‚
â”‚ database vá»›iâ”‚             â”‚
â”‚ thá»i háº¡n 5  â”‚             â”‚
â”‚ phÃºt        â”‚             â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜             â”‚
       â”‚                    â”‚
       â–¼                    â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚ Gá»­i email   â”‚             â”‚
â”‚ chá»©a mÃ£ OTP â”‚             â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜             â”‚
       â”‚                    â”‚
       â–¼                    â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚ Hiá»ƒn thá»‹    â”‚             â”‚
â”‚ trang "Nháº­p â”‚             â”‚
â”‚ mÃ£ xÃ¡c thá»±c"â”‚             â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜             â”‚
       â”‚                    â”‚
       â–¼                    â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚ NgÆ°á»i dÃ¹ng  â”‚             â”‚
â”‚ nháº­p mÃ£ OTP â”‚             â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜             â”‚
       â”‚                    â”‚
       â–¼                    â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚ NgÆ°á»i dÃ¹ng  â”‚             â”‚
â”‚ nháº¥n "XÃ¡c   â”‚             â”‚
â”‚ nháº­n"       â”‚             â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜             â”‚
       â”‚                    â”‚
       â–¼                    â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚ Há»‡ thá»‘ng    â”‚             â”‚
â”‚ kiá»ƒm tra OTPâ”‚             â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜             â”‚
       â”‚                    â”‚
       â–¼                    â”‚
  â—‡â”€â”€â”€â”€â”€â”€â”€â”€â”€â—‡               â”‚
 / OTP Ä‘Ãºng  \              â”‚
/  vÃ  cÃ²n háº¡n? \            â”‚
â—‡â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—‡             â”‚
â”‚             â”‚             â”‚
[CÃ³]        [KhÃ´ng]         â”‚
â”‚             â”‚             â”‚
â–¼             â–¼             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ Hiá»ƒn thá»‹ â”‚  â”‚ Hiá»ƒn thá»‹ â”‚  â”‚
â”‚ trang    â”‚  â”‚ lá»—i: "MÃ£ â”‚  â”‚
â”‚ "Táº¡o máº­t â”‚  â”‚ khÃ´ng    â”‚  â”‚
â”‚ kháº©u má»›i"â”‚  â”‚ Ä‘Ãºng hoáº·câ”‚  â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â”‚ Ä‘Ã£ háº¿t   â”‚  â”‚
     â”‚        â”‚ háº¡n"     â”‚  â”‚
     â”‚        â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â”‚
     â”‚             â”‚        â”‚
     â”‚             â””â”€â”€â”€â”€â”€â”€â”€â”€â”¤
     â”‚                      â”‚
     â–¼                      â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚ NgÆ°á»i dÃ¹ng  â”‚             â”‚
â”‚ nháº­p:       â”‚             â”‚
â”‚ - Máº­t kháº©u  â”‚             â”‚
â”‚   má»›i       â”‚             â”‚
â”‚ - XÃ¡c nháº­n  â”‚             â”‚
â”‚   máº­t kháº©u  â”‚             â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜             â”‚
       â”‚                    â”‚
       â–¼                    â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚ NgÆ°á»i dÃ¹ng  â”‚             â”‚
â”‚ nháº¥n "LÆ°u   â”‚             â”‚
â”‚ thay Ä‘á»•i"   â”‚             â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜             â”‚
       â”‚                    â”‚
       â–¼                    â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚ Validate:   â”‚             â”‚
â”‚ - Máº­t kháº©u  â”‚             â”‚
â”‚   >= 8 kÃ½ tá»±â”‚             â”‚
â”‚ - XÃ¡c nháº­n  â”‚             â”‚
â”‚   khá»›p      â”‚             â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜             â”‚
       â”‚                    â”‚
       â–¼                    â”‚
  â—‡â”€â”€â”€â”€â”€â”€â”€â”€â”€â—‡               â”‚
 / Há»£p lá»‡?   \              â”‚
â—‡â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—‡             â”‚
â”‚             â”‚             â”‚
[CÃ³]        [KhÃ´ng]         â”‚
â”‚             â”‚             â”‚
â–¼             â–¼             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ MÃ£ hÃ³a   â”‚  â”‚ Hiá»ƒn thá»‹ â”‚  â”‚
â”‚ máº­t kháº©u â”‚  â”‚ lá»—i      â”‚  â”‚
â”‚ má»›i      â”‚  â”‚ validate â”‚  â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â”‚
     â”‚             â”‚        â”‚
     â–¼             â””â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚ Cáº­p nháº­t    â”‚             â”‚
â”‚ máº­t kháº©u    â”‚             â”‚
â”‚ trong DB    â”‚             â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜             â”‚
       â”‚                    â”‚
       â–¼                    â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚ VÃ´ hiá»‡u hÃ³a â”‚             â”‚
â”‚ mÃ£ OTP      â”‚             â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜             â”‚
       â”‚                    â”‚
       â–¼                    â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚ Hiá»ƒn thá»‹    â”‚             â”‚
â”‚ thÃ´ng bÃ¡o   â”‚             â”‚
â”‚ "Äáº·t láº¡i    â”‚             â”‚
â”‚ máº­t kháº©u    â”‚             â”‚
â”‚ thÃ nh cÃ´ng!"â”‚             â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜             â”‚
       â”‚                    â”‚
       â–¼                    â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚ Redirect    â”‚             â”‚
â”‚ Ä‘áº¿n trang   â”‚             â”‚
â”‚ Ä‘Äƒng nháº­p   â”‚             â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜             â”‚
       â”‚                    â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â–¼
           [Káº¿t thÃºc]
```

### Triá»ƒn khai

**BÆ°á»›c 1: KÃ­ch hoáº¡t trong Clerk Dashboard**
```
1. ÄÄƒng nháº­p Clerk Dashboard
2. VÃ o User & Authentication â†’ Email, Phone, Username
3. Báº­t "Password reset"
4. Cáº¥u hÃ¬nh email template
```

**BÆ°á»›c 2: Customize Email Template (Optional)**
```html
<!-- Clerk Dashboard â†’ Emails â†’ Password Reset -->
<!DOCTYPE html>
<html>
<head>
  <style>
    body { font-family: Arial, sans-serif; }
    .container { max-width: 600px; margin: 0 auto; padding: 20px; }
    .code { font-size: 32px; font-weight: bold; color: #4F46E5; }
  </style>
</head>
<body>
  <div class="container">
    <h2>Äáº·t láº¡i máº­t kháº©u</h2>
    <p>Báº¡n Ä‘Ã£ yÃªu cáº§u Ä‘áº·t láº¡i máº­t kháº©u. MÃ£ xÃ¡c thá»±c cá»§a báº¡n lÃ :</p>
    <p class="code">{{code}}</p>
    <p>MÃ£ nÃ y cÃ³ hiá»‡u lá»±c trong 5 phÃºt.</p>
    <p>Náº¿u báº¡n khÃ´ng yÃªu cáº§u Ä‘áº·t láº¡i máº­t kháº©u, vui lÃ²ng bá» qua email nÃ y.</p>
  </div>
</body>
</html>
```

**BÆ°á»›c 3: ThÃªm link "QuÃªn máº­t kháº©u" vÃ o trang Ä‘Äƒng nháº­p**
```typescript
// app/(marketing)/_components/sign-in-form.tsx
import { useSignIn } from '@clerk/clerk-react';
import { useState } from 'react';

export function SignInForm() {
  const { signIn, setActive } = useSignIn();
  const [email, setEmail] = useState('');
  const [password, setPassword] = useState('');
  const [showReset, setShowReset] = useState(false);
  const [resetCode, setResetCode] = useState('');
  const [newPassword, setNewPassword] = useState('');
  
  // Normal sign in
  const handleSignIn = async (e: React.FormEvent) => {
    e.preventDefault();
    
    try {
      const result = await signIn.create({
        identifier: email,
        password,
      });
      
      if (result.status === 'complete') {
        await setActive({ session: result.createdSessionId });
      }
    } catch (err) {
      console.error(err);
    }
  };
  
  // Request password reset
  const handleForgotPassword = async () => {
    try {
      await signIn.create({
        strategy: 'reset_password_email_code',
        identifier: email,
      });
      
      setShowReset(true);
    } catch (err) {
      console.error(err);
    }
  };
  
  // Reset password with code
  const handleResetPassword = async (e: React.FormEvent) => {
    e.preventDefault();
    
    try {
      const result = await signIn.attemptFirstFactor({
        strategy: 'reset_password_email_code',
        code: resetCode,
        password: newPassword,
      });
      
      if (result.status === 'complete') {
        await setActive({ session: result.createdSessionId });
      }
    } catch (err) {
      console.error(err);
    }
  };
  
  if (showReset) {
    return (
      <form onSubmit={handleResetPassword}>
        <h2>Äáº·t láº¡i máº­t kháº©u</h2>
        <input
          type="text"
          placeholder="Nháº­p mÃ£ xÃ¡c thá»±c"
          value={resetCode}
          onChange={(e) => setResetCode(e.target.value)}
        />
        <input
          type="password"
          placeholder="Máº­t kháº©u má»›i"
          value={newPassword}
          onChange={(e) => setNewPassword(e.target.value)}
        />
        <button type="submit">Äáº·t láº¡i máº­t kháº©u</button>
      </form>
    );
  }
  
  return (
    <form onSubmit={handleSignIn}>
      <h2>ÄÄƒng nháº­p</h2>
      <input
        type="email"
        placeholder="Email"
        value={email}
        onChange={(e) => setEmail(e.target.value)}
      />
      <input
        type="password"
        placeholder="Máº­t kháº©u"
        value={password}
        onChange={(e) => setPassword(e.target.value)}
      />
      <button type="submit">ÄÄƒng nháº­p</button>
      <button type="button" onClick={handleForgotPassword}>
        QuÃªn máº­t kháº©u?
      </button>
    </form>
  );
}
```

---

## UC05: Cáº¬P NHáº¬T THÃ”NG TIN CÃ NHÃ‚N

### ThÃ´ng tin cÆ¡ báº£n
- **Use Case ID:** UC05
- **Tráº¡ng thÃ¡i:** âŒ ChÆ°a triá»ƒn khai
- **Má»©c Ä‘á»™ Æ°u tiÃªn:** ğŸŸ¡ TRUNG BÃŒNH
- **TÃ¡c nhÃ¢n:** NgÆ°á»i dÃ¹ng há»‡ thá»‘ng

### Biá»ƒu Ä‘á»“ hoáº¡t Ä‘á»™ng

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              UC05: Cáº¬P NHáº¬T THÃ”NG TIN CÃ NHÃ‚N                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    [Báº¯t Ä‘áº§u]
        â”‚
        â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ NgÆ°á»i dÃ¹ng truy cáº­p   â”‚
    â”‚ trang "Há»“ sÆ¡ cÃ¡ nhÃ¢n" â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Há»‡ thá»‘ng load thÃ´ng   â”‚
    â”‚ tin hiá»‡n táº¡i tá»« DB:   â”‚
    â”‚ - Há» tÃªn              â”‚
    â”‚ - áº¢nh Ä‘áº¡i diá»‡n        â”‚
    â”‚ - Email (read-only)   â”‚
    â”‚ - Sá»‘ Ä‘iá»‡n thoáº¡i       â”‚
    â”‚ - Giá»›i tÃ­nh           â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Hiá»ƒn thá»‹ form vá»›i     â”‚
    â”‚ dá»¯ liá»‡u hiá»‡n táº¡i      â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ NgÆ°á»i dÃ¹ng cÃ³ thá»ƒ:    â”‚
    â”‚ - Sá»­a há» tÃªn          â”‚
    â”‚ - Upload áº£nh má»›i      â”‚
    â”‚ - Sá»­a sá»‘ Ä‘iá»‡n thoáº¡i   â”‚
    â”‚ - Chá»n giá»›i tÃ­nh      â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â–¼
         â—‡â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—‡
        /  NgÆ°á»i dÃ¹ng   \
       /   nháº¥n nÃºt gÃ¬?  \
      â—‡â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—‡
      â”‚                   â”‚
  [LÆ°u thay Ä‘á»•i]      [Há»§y bá»]
      â”‚                   â”‚
      â–¼                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Validate    â”‚    â”‚ Há»§y bá» má»i   â”‚
â”‚ dá»¯ liá»‡u     â”‚    â”‚ thay Ä‘á»•i     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                  â”‚
       â–¼                  â”‚
  â—‡â”€â”€â”€â”€â”€â”€â”€â”€â”€â—‡             â”‚
 / Há» tÃªn    \            â”‚
/  khÃ´ng trá»‘ng?\          â”‚
â—‡â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—‡           â”‚
â”‚             â”‚           â”‚
[CÃ³]        [KhÃ´ng]       â”‚
â”‚             â”‚           â”‚
â–¼             â–¼           â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚ Kiá»ƒm tra â”‚  â”‚ Hiá»ƒn thá»‹ â”‚â”‚
â”‚ áº£nh Ä‘áº¡i  â”‚  â”‚ lá»—i: "Há» â”‚â”‚
â”‚ diá»‡n     â”‚  â”‚ tÃªn khÃ´ngâ”‚â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â”‚ Ä‘Æ°á»£c Ä‘á»ƒ  â”‚â”‚
     â”‚        â”‚ trá»‘ng"   â”‚â”‚
     â”‚        â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜â”‚
     â–¼             â”‚      â”‚
â—‡â”€â”€â”€â”€â”€â”€â”€â”€â”€â—‡        â”‚      â”‚
/ CÃ³ upload \      â”‚      â”‚
\ áº£nh má»›i?  /      â”‚      â”‚
â—‡â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—‡      â”‚      â”‚
â”‚           â”‚      â”‚      â”‚
[CÃ³]      [KhÃ´ng] â”‚      â”‚
â”‚           â”‚      â”‚      â”‚
â–¼           â”‚      â”‚      â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚      â”‚      â”‚
â”‚ Validate â”‚â”‚      â”‚      â”‚
â”‚ áº£nh:     â”‚â”‚      â”‚      â”‚
â”‚ - Äá»‹nh   â”‚â”‚      â”‚      â”‚
â”‚   dáº¡ng   â”‚â”‚      â”‚      â”‚
â”‚   JPG/PNGâ”‚â”‚      â”‚      â”‚
â”‚ - Dung   â”‚â”‚      â”‚      â”‚
â”‚   lÆ°á»£ng  â”‚â”‚      â”‚      â”‚
â”‚   <= 5MB â”‚â”‚      â”‚      â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜â”‚      â”‚      â”‚
     â”‚      â”‚      â”‚      â”‚
     â–¼      â”‚      â”‚      â”‚
â—‡â”€â”€â”€â”€â”€â”€â”€â”€â”€â—‡ â”‚      â”‚      â”‚
/ áº¢nh há»£p  \â”‚      â”‚      â”‚
\  lá»‡?     /â”‚      â”‚      â”‚
â—‡â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—‡      â”‚      â”‚
â”‚           â”‚      â”‚      â”‚
[CÃ³]      [KhÃ´ng] â”‚      â”‚
â”‚           â”‚      â”‚      â”‚
â–¼           â–¼      â”‚      â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚ Upload   â”‚â”‚ Hiá»ƒn thá»‹â”‚   â”‚
â”‚ áº£nh lÃªn  â”‚â”‚ lá»—i áº£nh â”‚   â”‚
â”‚ EdgeStoreâ”‚â”‚ khÃ´ng   â”‚   â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜â”‚ há»£p lá»‡  â”‚   â”‚
     â”‚      â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜   â”‚
     â–¼           â”‚        â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚        â”‚
â”‚ Nháº­n URL    â”‚  â”‚        â”‚
â”‚ áº£nh tá»«      â”‚  â”‚        â”‚
â”‚ EdgeStore   â”‚  â”‚        â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â”‚        â”‚
       â”‚         â”‚        â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤        â”‚
                 â”‚        â”‚
                 â–¼        â”‚
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
       â”‚ Gá»i Convex  â”‚    â”‚
       â”‚ mutation:   â”‚    â”‚
       â”‚ updateProfileâ”‚   â”‚
       â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â”‚
              â”‚           â”‚
              â–¼           â”‚
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
       â”‚ Cáº­p nháº­t DB:â”‚    â”‚
       â”‚ - fullName  â”‚    â”‚
       â”‚ - avatarUrl â”‚    â”‚
       â”‚ - phone     â”‚    â”‚
       â”‚ - gender    â”‚    â”‚
       â”‚ - updatedAt â”‚    â”‚
       â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â”‚
              â”‚           â”‚
              â–¼           â”‚
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
       â”‚ Cáº­p nháº­t    â”‚    â”‚
       â”‚ Clerk user  â”‚    â”‚
       â”‚ metadata    â”‚    â”‚
       â”‚ (optional)  â”‚    â”‚
       â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â”‚
              â”‚           â”‚
              â–¼           â”‚
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
       â”‚ Hiá»ƒn thá»‹    â”‚    â”‚
       â”‚ thÃ´ng bÃ¡o   â”‚    â”‚
       â”‚ "Cáº­p nháº­t   â”‚    â”‚
       â”‚ thÃ nh cÃ´ng!"â”‚    â”‚
       â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â”‚
              â”‚           â”‚
              â–¼           â”‚
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
       â”‚ LÃ m má»›i     â”‚    â”‚
       â”‚ giao diá»‡n   â”‚    â”‚
       â”‚ vá»›i dá»¯ liá»‡u â”‚    â”‚
       â”‚ má»›i         â”‚    â”‚
       â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â”‚
              â”‚           â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
              [Káº¿t thÃºc]
```

### Triá»ƒn khai chi tiáº¿t

**BÆ°á»›c 1: Táº¡o schema**
```typescript
// convex/schema.ts
users: defineTable({
  clerkId: v.string(),
  fullName: v.string(),
  email: v.string(),
  phone: v.optional(v.string()),
  gender: v.optional(v.string()),
  avatarUrl: v.optional(v.string()),
  createdAt: v.number(),
  updatedAt: v.number(),
})
.index("by_clerk_id", ["clerkId"])
```

**BÆ°á»›c 2: Táº¡o Convex mutations/queries**
```typescript
// convex/users.ts
import { v } from "convex/values";
import { mutation, query } from "./_generated/server";

export const getProfile = query({
  handler: async (ctx) => {
    const identity = await ctx.auth.getUserIdentity();
    if (!identity) throw new Error("Unauthorized");
    
    const user = await ctx.db
      .query("users")
      .withIndex("by_clerk_id", q => q.eq("clerkId", identity.subject))
      .first();
    
    return user;
  }
});

export const updateProfile = mutation({
  args: {
    fullName: v.string(),
    phone: v.optional(v.string()),
    gender: v.optional(v.string()),
    avatarUrl: v.optional(v.string()),
  },
  handler: async (ctx, args) => {
    const identity = await ctx.auth.getUserIdentity();
    if (!identity) throw new Error("Unauthorized");
    
    // Validate
    if (!args.fullName || args.fullName.trim() === "") {
      throw new Error("Há» tÃªn khÃ´ng Ä‘Æ°á»£c Ä‘á»ƒ trá»‘ng");
    }
    
    const user = await ctx.db
      .query("users")
      .withIndex("by_clerk_id", q => q.eq("clerkId", identity.subject))
      .first();
    
    if (!user) throw new Error("User not found");
    
    await ctx.db.patch(user._id, {
      fullName: args.fullName,
      phone: args.phone,
      gender: args.gender,
      avatarUrl: args.avatarUrl,
      updatedAt: Date.now(),
    });
    
    return user._id;
  }
});
```

**BÆ°á»›c 3: Táº¡o Profile Page**
```typescript
// app/(main)/(routes)/profile/page.tsx
"use client";

import { useQuery, useMutation } from "convex/react";
import { api } from "@/convex/_generated/api";
import { ProfileForm } from "./_components/profile-form";
import { Spinner } from "@/components/spinner";

export default function ProfilePage() {
  const profile = useQuery(api.users.getProfile);
  
  if (profile === undefined) {
    return <Spinner />;
  }
  
  if (profile === null) {
    return <div>Profile not found</div>;
  }
  
  return (
    <div className="max-w-2xl mx-auto p-8">
      <h1 className="text-3xl font-bold mb-8">Há»“ sÆ¡ cÃ¡ nhÃ¢n</h1>
      <ProfileForm initialData={profile} />
    </div>
  );
}
```

**BÆ°á»›c 4: Táº¡o Profile Form Component**
```typescript
// app/(main)/(routes)/profile/_components/profile-form.tsx
"use client";

import { useState } from "react";
import { useMutation } from "convex/react";
import { api } from "@/convex/_generated/api";
import { toast } from "sonner";
import { AvatarUpload } from "./avatar-upload";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Label } from "@/components/ui/label";
import {
  Select,
  SelectContent,
  SelectItem,
  SelectTrigger,
  SelectValue,
} from "@/components/ui/select";

interface ProfileFormProps {
  initialData: {
    fullName: string;
    email: string;
    phone?: string;
    gender?: string;
    avatarUrl?: string;
  };
}

export function ProfileForm({ initialData }: ProfileFormProps) {
  const updateProfile = useMutation(api.users.updateProfile);
  
  const [fullName, setFullName] = useState(initialData.fullName);
  const [phone, setPhone] = useState(initialData.phone || "");
  const [gender, setGender] = useState(initialData.gender || "");
  const [avatarUrl, setAvatarUrl] = useState(initialData.avatarUrl || "");
  const [isSubmitting, setIsSubmitting] = useState(false);
  
  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    
    if (!fullName.trim()) {
      toast.error("Há» tÃªn khÃ´ng Ä‘Æ°á»£c Ä‘á»ƒ trá»‘ng");
      return;
    }
    
    setIsSubmitting(true);
    
    try {
      await updateProfile({
        fullName,
        phone: phone || undefined,
        gender: gender || undefined,
        avatarUrl: avatarUrl || undefined,
      });
      
      toast.success("Cáº­p nháº­t thÃ nh cÃ´ng!");
    } catch (error) {
      toast.error("CÃ³ lá»—i xáº£y ra");
      console.error(error);
    } finally {
      setIsSubmitting(false);
    }
  };
  
  return (
    <form onSubmit={handleSubmit} className="space-y-6">
      {/* Avatar Upload */}
      <div>
        <Label>áº¢nh Ä‘áº¡i diá»‡n</Label>
        <AvatarUpload
          value={avatarUrl}
          onChange={setAvatarUrl}
        />
      </div>
      
      {/* Full Name */}
      <div>
        <Label htmlFor="fullName">Há» tÃªn *</Label>
        <Input
          id="fullName"
          value={fullName}
          onChange={(e) => setFullName(e.target.value)}
          placeholder="Nguyá»…n VÄƒn A"
          required
        />
      </div>
      
      {/* Email (read-only) */}
      <div>
        <Label htmlFor="email">Email</Label>
        <Input
          id="email"
          value={initialData.email}
          disabled
          className="bg-gray-100"
        />
      </div>
      
      {/* Phone */}
      <div>
        <Label htmlFor="phone">Sá»‘ Ä‘iá»‡n thoáº¡i</Label>
        <Input
          id="phone"
          type="tel"
          value={phone}
          onChange={(e) => setPhone(e.target.value)}
          placeholder="0123456789"
        />
      </div>
      
      {/* Gender */}
      <div>
        <Label>Giá»›i tÃ­nh</Label>
        <Select value={gender} onValueChange={setGender}>
          <SelectTrigger>
            <SelectValue placeholder="Chá»n giá»›i tÃ­nh" />
          </SelectTrigger>
          <SelectContent>
            <SelectItem value="male">Nam</SelectItem>
            <SelectItem value="female">Ná»¯</SelectItem>
            <SelectItem value="other">KhÃ¡c</SelectItem>
          </SelectContent>
        </Select>
      </div>
      
      {/* Buttons */}
      <div className="flex gap-4">
        <Button type="submit" disabled={isSubmitting}>
          {isSubmitting ? "Äang lÆ°u..." : "LÆ°u thay Ä‘á»•i"}
        </Button>
        <Button
          type="button"
          variant="outline"
          onClick={() => window.history.back()}
        >
          Há»§y bá»
        </Button>
      </div>
    </form>
  );
}
```

**BÆ°á»›c 5: Táº¡o Avatar Upload Component**
```typescript
// app/(main)/(routes)/profile/_components/avatar-upload.tsx
"use client";

import { useState } from "react";
import { useEdgeStore } from "@/lib/edgestore";
import { SingleImageDropzone } from "@/components/single-image-dropzone";
import { Avatar, AvatarImage, AvatarFallback } from "@/components/ui/avatar";
import { Button } from "@/components/ui/button";
import { toast } from "sonner";

interface AvatarUploadProps {
  value: string;
  onChange: (url: string) => void;
}

export function AvatarUpload({ value, onChange }: AvatarUploadProps) {
  const { edgestore } = useEdgeStore();
  const [file, setFile] = useState<File>();
  const [isUploading, setIsUploading] = useState(false);
  
  const handleUpload = async (file?: File) => {
    if (!file) return;
    
    // Validate file type
    if (!file.type.startsWith("image/")) {
      toast.error("Chá»‰ cháº¥p nháº­n file áº£nh");
      return;
    }
    
    // Validate file size (5MB)
    if (file.size > 5 * 1024 * 1024) {
      toast.error("KÃ­ch thÆ°á»›c áº£nh khÃ´ng Ä‘Æ°á»£c vÆ°á»£t quÃ¡ 5MB");
      return;
    }
    
    setIsUploading(true);
    setFile(file);
    
    try {
      const res = await edgestore.publicFiles.upload({
        file,
        options: {
          replaceTargetUrl: value,
        },
      });
      
      onChange(res.url);
      toast.success("Upload áº£nh thÃ nh cÃ´ng");
    } catch (error) {
      toast.error("Upload áº£nh tháº¥t báº¡i");
      console.error(error);
    } finally {
      setIsUploading(false);
      setFile(undefined);
    }
  };
  
  return (
    <div className="flex items-center gap-4">
      <Avatar className="h-24 w-24">
        <AvatarImage src={value} />
        <AvatarFallback>Avatar</AvatarFallback>
      </Avatar>
      
      <div>
        <SingleImageDropzone
          value={file}
          onChange={handleUpload}
          disabled={isUploading}
        />
        <p className="text-sm text-gray-500 mt-2">
          JPG, PNG. Tá»‘i Ä‘a 5MB.
        </p>
      </div>
    </div>
  );
}
```

---

*TÃ i liá»‡u nÃ y sáº½ tiáº¿p tá»¥c vá»›i cÃ¡c use case cÃ²n láº¡i...*

## UC06-UC19: [Tiáº¿p tá»¥c trong pháº§n 2]

TÃ i liá»‡u sáº½ Ä‘Æ°á»£c chia thÃ nh nhiá»u file Ä‘á»ƒ dá»… quáº£n lÃ½:
- `USE_CASES_DETAILED_PART1.md` (UC01-UC05) - File nÃ y
- `USE_CASES_DETAILED_PART2.md` (UC06-UC10)
- `USE_CASES_DETAILED_PART3.md` (UC11-UC15)
- `USE_CASES_DETAILED_PART4.md` (UC16-UC19)

---

**NgÆ°á»i thá»±c hiá»‡n:** AI Assistant
**NgÃ y:** 01/12/2025
**PhiÃªn báº£n:** 1.0
